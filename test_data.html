<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç –¥–∞–Ω–Ω—ã—Ö</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { margin: 5px; padding: 10px; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <h1>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ–º–µ–π–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞</h1>
    
    <div id="file-status" style="margin-bottom: 20px;"></div>
    
    <div>
        <button onclick="loadData('data_mini.json')">–ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∏–Ω–∏-–¥–∞–Ω–Ω—ã–µ (5 —á–µ–ª)</button>
        <button onclick="loadData('data.json')">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (15 —á–µ–ª)</button>
        <button onclick="clearData()">–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        <button onclick="checkFiles()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª—ã</button>
    </div>
    
    <div id="result" style="margin-top: 20px;"></div>
    
    <script>
        async function checkFiles() {
            const files = ['data.json', 'data_mini.json'];
            const statusDiv = document.getElementById('file-status');
            let html = '<h3>–°—Ç–∞—Ç—É—Å —Ñ–∞–π–ª–æ–≤:</h3>';
            
            for (const file of files) {
                try {
                    const response = await fetch(file);
                    if (response.ok) {
                        html += `<p class="success">‚úÖ ${file} - –Ω–∞–π–¥–µ–Ω</p>`;
                    } else {
                        html += `<p class="error">‚ùå ${file} - –Ω–µ –Ω–∞–π–¥–µ–Ω (${response.status})</p>`;
                    }
                } catch (error) {
                    html += `<p class="error">‚ùå ${file} - –æ—à–∏–±–∫–∞: ${error.message}</p>`;
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º LocalStorage
            const hasData = localStorage.getItem('familyTreeData');
            html += `<p class="${hasData ? 'success' : 'warning'}">${hasData ? '‚úÖ' : '‚ö†Ô∏è'} LocalStorage: ${hasData ? '–µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ' : '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}</p>`;
            
            statusDiv.innerHTML = html;
        }
        
        async function loadData(filename) {
            try {
                const response = await fetch(filename);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                const data = await response.json();
                localStorage.setItem('familyTreeData', JSON.stringify(data));
                document.getElementById('result').innerHTML = `
                    <h3 class="success">‚úÖ –î–∞–Ω–Ω—ã–µ "${filename}" –∑–∞–≥—Ä—É–∂–µ–Ω—ã</h3>
                    <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π: ${data.people.length}</p>
                    <p><a href="/">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a> (–æ–±–Ω–æ–≤–∏—Ç–µ –µ—ë –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏)</p>
                    <pre>${JSON.stringify(data, null, 2).substring(0, 1000)}...</pre>
                `;
                checkFiles(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    <h3 class="error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ${filename}</h3>
                    <p><strong>${error.message}</strong></p>
                    <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</p>
                    <ul>
                        <li>–°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª ${filename} –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ</li>
                        <li>–ó–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 8760</li>
                        <li>–ù–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞</li>
                    </ul>
                    <button onclick="checkFiles()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª—ã</button>
                `;
            }
        }
        
        function clearData() {
            localStorage.removeItem('familyTreeData');
            document.getElementById('result').innerHTML = `
                <h3 class="warning">üóëÔ∏è –î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã</h3>
                <p>–ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞</p>
            `;
            checkFiles();
        }
        
        // –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = checkFiles;
    </script>
</body>
</html>
